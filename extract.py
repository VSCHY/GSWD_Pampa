from shapely.geometry import Polygon
import numpy as np
import numpy.ma as ma
from src import *
import pandas as pd

#############################

reg = [[-62.878110331793195,-32.74842956774214],  
       [-62.878577831409174,-33.178678995876254],
       [-62.84994707339325,-33.17902780196107],
       [-62.81891294176473,-33.17933336833423],
       [-62.794626241191565,-33.178616597024934], 
       [-62.76840855749845,-33.178577192684116],
       [-62.71502819399984,-33.17898577340224],
       [-62.61667550939528,-33.17902262759041],
       [-62.41370625988214,-33.179514247553485],
       [-62.24942293422193,-33.17924697939642],
       [-62.08617635435076,-33.17905225769847],
       [-62.088574296195034,-33.03698428234276],
       [-62.08597760908219,-32.834497396675786],
       [-62.08619458437756,-32.68641297797339],
       [-62.08810153337718,-32.32458814266522],
       [-62.183869404549895,-32.32526947435013],
       [-62.29611477652926,-32.32354803025234], 
       [-62.402125477186296,-32.32475274327844],
       [-62.51499713530935,-32.324121902063304], 
       [-62.69579462805929,-32.32442568179923],
       [-62.78825508574745,-32.3238999240949], 
       [-62.841695712839886,-32.32274176070722],
       [-62.87865858004847,-32.32736988642978], 
       [-62.877059880708224,-32.43857356442368],
       [-62.8779305098461,-32.59321181544196], 
       [-62.878110331793195,-32.74842956774214]]
       
poly = Polygon(reg)

##########################

L = []
for year in range(2000,2022):
    for month in range(1,13):
        D = {}        
        lon, lat, data = get_data_raster(month, year)
        nsize = data.size
        missing = np.count_nonzero(data == 255)/nsize
        out = ma.masked_where(data==255, data)/100
        flooded = np.sum(out)/nsize
        D = {"Date":f"01/{month:02d}/{year}","missing":missing, "flooded":flooded}
        L.append(D)
        
df = pd.DataFrame.from_dict(L, orient = "columns")



